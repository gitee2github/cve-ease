Name:           cve-ease
Version:        VERSION
Release:        RELEASE
Summary:        CTyunOS cve-ease project.
URL:            https://gitee.com/openeuler/cve-ease
License:        MulanPSL2
Source0:        cve-ease-%{version}.tar.bz2
AutoReqProv:    no

BuildRequires:  python3

Requires:       systemd
Requires:       python3
Requires:       python3-requests
Requires:       python3-flask
Requires:       python3-sqlalchemy
Requires:       python3-pandas
Requires:       python3-dbus

%description
CTyunOS cve-ease project.

Provides:       %{name} = %{version}-%{release}
Group:          System Environment/Daemons

%{?systemd_requires}

%prep
tar -xf %{_sourcedir}/%{name}-%{version}.tar.bz2 

%build

%install
cd %{_builddir}/%{name}-%{version}
make install DESTDIR=%{buildroot}

%post
%systemd_post cve-ease.service
systemctl enable cve-ease.service

%preun
%systemd_preun cve-ease.service

%postun
%systemd_postun_with_restart cve-ease.service

%files
%attr(0755,root,root) /usr/bin/cve-ease
%attr(0755,root,root) /usr/bin/cve-ease-notifier
%attr(0644,root,root) /usr/lib/systemd/system/cve-ease.service
%attr(0644,root,root) /usr/lib/systemd/system/cve-ease.timer
%attr(0644,root,root) /var/log/cve-ease/log
%{python3_sitelib}/cve_ease

%changelog
* Thu Mar 02 2022 youyifeng <youyf2@chinatelecom.cn> - 0.0.6-1
- add cvrf/cve/sa scrapy and systemd service controller

* Thu Mar 02 2022 youyifeng <youyf2@chinatelecom.cn> - 0.0.5-1
- Update and bugfix

* Mon May 23 2022 youyifeng <youyf2@chinatelecom.cn> - 0.0.4-1
- Update and bugfix

* Mon May 9 2022 youyifeng <youyf2@chinatelecom.cn> - 0.0.2-1
- First publish
