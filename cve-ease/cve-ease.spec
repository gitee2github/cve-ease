Name:           cve-ease
Version:        VERSION
Release:        RELEASE
Summary:        CTyunOS cve-ease project.
URL:            https://gitee.com/openeuler/cve-ease
License:        MulanPSL2
Source0:        cve-ease-%{version}.tar.bz2
AutoReqProv:    no

BuildRequires:  python3

Requires:       systemd
Requires:       python3
Requires:       python3-requests
Requires:       python3-flask
Requires:       python3-sqlalchemy
Requires:       python3-pandas
Requires:       python3-dbus
Requires:       python3-defusedxml

%description

CTyunOS cve-ease project.

Collect and analysis CVE information published by the community,
differential broadcast it to users through various channels,
and provide multiple interfaces to security manufacturer to
improve the capability of system security management.


Provides:       %{name} = %{version}-%{release}
Group:          System Environment/Daemons

%{?systemd_requires}

%prep
tar -xf %{_sourcedir}/%{name}-%{version}.tar.bz2 

%build

%install
cd %{_builddir}/%{name}-%{version}
make install DESTDIR=%{buildroot}

%post
%systemd_post cve-ease.service
systemctl enable cve-ease.service

%preun
%systemd_preun cve-ease.service

%postun
%systemd_postun_with_restart cve-ease.service

%files
/etc/cve-ease/cve-ease.cfg
%attr(0755,root,root) /usr/bin/cve-ease
%attr(0644,root,root) /usr/lib/systemd/system/cve-ease.service
%attr(0644,root,root) /usr/lib/systemd/system/cve-ease.timer
%{python3_sitelib}/cve_ease
/var/log/cve-ease
/usr/share/cve-ease

%changelog
* Sun Mar 12 2023 youyifeng <youyf2@chinatelecom.cn> - 0.1.0-1
- remove cve-ease-notifier, using cve-ease as cli and daemon

* Fri Mar 10 2023 youyifeng <youyf2@chinatelecom.cn> - 0.0.9-1
- add subcommand daemon/repodata/logger

* Tue Mar 07 2023 youyifeng <youyf2@chinatelecom.cn> - 0.0.8-1
- add dingding/feishu/mail163 notifier

* Sun Mar 05 2023 youyifeng <youyf2@chinatelecom.cn> - 0.0.7-1
- add cvrf/cve/sa scrapy and systemd service controller

* Sat Mar 04 2023 youyifeng <youyf2@chinatelecom.cn> - 0.0.6-1
- add cvrf/cve/sa scrapy and systemd service controller

* Thu Mar 02 2023 youyifeng <youyf2@chinatelecom.cn> - 0.0.5-1
- Update and bugfix

* Mon May 23 2022 youyifeng <youyf2@chinatelecom.cn> - 0.0.4-1
- Update and bugfix

* Mon May 9 2022 youyifeng <youyf2@chinatelecom.cn> - 0.0.2-1
- First publish
