# -*- coding: utf-8 -*-

"""
 (c) 2023 - Copyright CTyunOS Inc

 Authors:
   youyifeng <youyf2@chinatelecom.cn>

"""


def one_instance_check(lockfile):
    """
    Helper function for one instance checking
    """
    running_status = False
    lock_file_pointer = os.open(lockfile, os.O_CREAT | os.O_WRONLY)
    try:
        fcntl.lockf(lock_file_pointer, fcntl.LOCK_EX | fcntl.LOCK_NB)
    except IOError:
        running_status = True
    return running_status


def get_timestamp():
    """
    Helper function for getting timestamp
    """
    return datetime.datetime.now().strftime("%Y-%m-%d %H:%M:%S")


def data_to_csv(list_of_dict, column_list):
    """
    Helper function for dict to csv
    """
    import pandas as pd
    df = pd.DataFrame(list_of_dict)
    df.columns = column_list
    return df.to_csv(index=False)


def to_list(lst):
    """
    Helper function for py2/py3 compatibility
    """
    if isinstance(lst, list):
        return lst
    else:
        return list(lst)
