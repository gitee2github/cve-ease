# -*- coding: utf-8 -*-

"""
 (c) 2023 - Copyright CTyunOS Inc

 Authors:
   youyifeng <youyf2@chinatelecom.cn>

"""

from .base import DBModel
from sqlalchemy import Column
from sqlalchemy import Text
from sqlalchemy import Integer


class SA(DBModel):
    __tablename__ = 'OpenEulerSA'

    id = Column('id', Integer, primary_key=True)
    affectedComponent = Column('affectedComponent', Text)
    affectedProduct = Column('affectedProduct', Text)
    announcementTime = Column('announcementTime', Text)
    cveId = Column('cveId', Text)
    description = Column('description', Text)
    introduction = Column('introduction', Text)
    packageName = Column('packageName', Text)
    referenceDocuments = Column('referenceDocuments', Text)
    revisionHistory = Column('revisionHistory', Text)
    securityNoticeNo = Column('securityNoticeNo', Text)
    subject = Column('subject', Text)
    summary = Column('summary', Text)
    type = Column('type', Text)
    updateTime = Column('updateTime', Text)
    cvrf = Column('cvrf', Text)

    # packageHelperList = Column('packageHelperList', Text)
    # packageList = Column('packageList', Text)
    # referenceList = Column('referenceList', Text)
    # cveList = Column('cveList', Text)

    @staticmethod
    def pretty_output_title():
        print("%-20s %-30s %-10s %-20s" % ("securityNoticeID", "AffectedComponent", "CVEID", "UpdateTime"))

    def pretty_output(self):
        print("%-20s %-30s %-10s %-20s" % (
            self.securityNoticeNo,
            self.affectedComponent,
            self.cveId,
            self.updateTime,
        ))

    def simple_output(self):
        print("""SecurityNoticeNo: %s
AffectedComponent: %s
CVEID: %s
UpdateTime: %s
Link: https://www.openeuler.org/zh/security/safety-bulletin/detail/?id=%s
""" % (
            self.securityNoticeNo,
            self.affectedComponent,
            self.cveId,
            self.updateTime,
            self.securityNoticeNo,
        ))
